#import "../../components/JobCard.graphql"

fragment JobsListJob on jobs {
  id
  pickup_required

  target {
    id
    name
    street
    city
    province
  }

  successfulAttempts: attempts_aggregate(where: { success: { _eq: true } }) {
    aggregate {
      count
    }
  }
  allAttempts: attempts_aggregate {
    aggregate {
      count
    }
  }

  documents_aggregate {
    aggregate {
      count
    }
  }
}

query JobsList($userId: uuid!, $isLawyer: Boolean!) {
  users(where: { id: { _eq: $userId } }) {
    id
    ...PageUser
  }

  lawyerJobs: jobs @include(if: $isLawyer) {
    id

    ...JobsListJob
    ...JobCardJob
  }

  serverJobs: jobs(where: { server_user_id: { _eq: $userId } })
    @skip(if: $isLawyer) {
    id

    ...JobsListJob
    ...JobCardJob
  }
}
