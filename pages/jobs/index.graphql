#import "../../components/JobCard.graphql"

fragment JobsListJob on jobs {
  id
  pickup_required

  target_name
  target_address {
    id
    street
    city
    postal_code
    province
  }

  successfulAttempts: attempts_aggregate(where: { success: { _eq: true } }) {
    aggregate {
      count
    }
  }
  allAttempts: attempts_aggregate {
    aggregate {
      count
    }
  }

  documents_aggregate {
    aggregate {
      count
    }
  }
}

query JobsList($userId: uuid!, $isLawyer: Boolean!) {
  lawyerJobs: jobs(order_by: { created_at: desc }) @include(if: $isLawyer) {
    id

    ...JobsListJob
    ...JobCardJob
  }

  serverJobs: jobs(
    order_by: { created_at: desc }
    where: { server_user_id: { _eq: $userId } }
  ) @skip(if: $isLawyer) {
    id

    ...JobsListJob
    ...JobCardJob
  }

  ...PageQuery
}
